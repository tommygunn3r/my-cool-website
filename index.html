<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Gunner's Games</title>

<style>
/* === GLOBAL RESET === */
* { margin:0; padding:0; box-sizing:border-box; }
html, body {
    width:100%;
    height:100%;
    background:#000 !important;
    color:white;
    font-family:Arial, sans-serif;
    overflow-x:hidden;
}

header, main, footer, .game-card {
    background:#000 !important;
}

/* HEADER */
header {
    padding:20px 0;
    border-bottom:3px solid #e94560;
    position:relative;
    text-align:center;
}

/* SHRUNK BANNER */
.banner img {
    width:70%;
    max-width:420px;
    height:auto;
}

/* (Old user-bar styles kept) */
.user-bar {
    position:absolute;
    top:15px;
    right:15px;
    display:flex;
    align-items:center;
    gap:10px;
    z-index:30;
}
.auth-btn {
    background:transparent;
    border:2px solid #e94560;
    color:#e94560;
    padding:6px 14px;
    border-radius:6px;
    cursor:pointer;
    font-size:0.85rem;
    font-weight:bold;
}
.user-bar-auth {
    display:flex;
    align-items:center;
    gap:12px;
    background:#111;
    border:1px solid #333;
    padding:6px 14px;
    border-radius:40px;
}
.settings-btn {
    cursor:pointer;
    font-size:20px;
    color:#e94560;
}
#settingsMenu {
    position:absolute;
    top:55px;
    right:0px;
    width:180px;
    background:#111;
    border:1px solid #333;
    border-radius:10px;
    display:none;
    flex-direction:column;
    z-index:90;
}
#settingsMenu div {
    padding:10px 16px;
    cursor:pointer;
}
#settingsMenu div:hover {
    background:#222;
    color:#e94560;
}

/* GAME GRID */
main {
    width:100%;
    max-width:1200px;
    margin:auto;
    padding:20px;
}
.game-categories {
    display:flex;
    flex-direction:column;
    gap:20px;
}
.game-card {
    border-radius:20px;
    border:2px solid #111;
    overflow:hidden;
    cursor:pointer;
    transition:0.2s;
}
.game-card:hover { border-color:#e94560; }
.game-card.disabled {
    opacity:0.35;
    pointer-events:none;
    filter:grayscale(100%);
}
.game-image img {
    width:100%;
    height:200px;
    object-fit:contain;
}

/* Desktop grid */
@media(min-width:768px){
    .game-categories {
        flex-direction:row;
        flex-wrap:wrap;
    }
    .game-card {
        flex:1 1 calc(25% - 20px);
        max-width:260px;
    }
}

/* FOOTER */
footer {
    padding:20px;
    border-top:3px solid #e94560;
    text-align:center;
    background:#000;
}
footer a {
    color:#aaa;
    text-decoration:none;
    margin:0 10px;
}
footer a:hover { color:#e94560; }

/* AUTH MODALS (unchanged) */
#authModal, #resetPasswordModal, #changeNameModal {
    position:fixed;
    inset:0;
    display:none;
    align-items:center;
    justify-content:center;
    background:rgba(0,0,0,0.88);
    z-index:999999;
}
.modal-content {
    background:#111;
    padding:28px;
    width:90%;
    max-width:380px;
    border-radius:12px;
    border:2px solid #e94560;
    position:relative;
}
.close-modal {
    position:absolute;
    top:10px;
    right:14px;
    font-size:28px;
    cursor:pointer;
}
.modal-content h2 {
    text-align:center;
    color:#e94560;
    margin-bottom:18px;
}

.input-group { margin-bottom:12px; }
label { display:block; margin-bottom:4px; color:#aaa; }
.input-field {
    width:100%;
    padding:10px;
    background:#000;
    border:1px solid #333;
    color:white;
    border-radius:6px;
}

.submit-btn {
    width:100%;
    padding:12px;
    background:#e94560;
    color:white;
    border:none;
    border-radius:6px;
    margin-top:10px;
    cursor:pointer;
    font-size:1.1rem;
}

.switch-link { text-align:center; margin-top:12px; color:#bbb; }
.switch-link span { color:#e94560; cursor:pointer; }

.error-msg { color:#ff4444; display:none; margin-top:4px; }
</style>
</head>

<body>

<!-- GLOBAL PLAYER BAR -->
<div id="playerbar"></div>

<!-- HEADER -->
<header>
    <div class="banner">
        <img src="assets/banner.png">
    </div>
</header>

<!-- MAIN GAME GRID -->
<main id="gameContainer">
    <div class="game-categories">

        <div class="game-card" data-game="arcade.html" onclick="location.href='arcade.html'">
            <div class="game-image"><img src="assets/arcade.png"></div>
        </div>

        <div class="game-card" data-game="casino.html" onclick="location.href='casino.html'">
            <div class="game-image"><img src="assets/casino.png"></div>
        </div>

        <div class="game-card" data-game="solitaire.html" onclick="location.href='solitaire.html'">
            <div class="game-image"><img src="assets/solitaire.png"></div>
        </div>

        <div class="game-card" data-game="multiplayer/index.html" onclick="location.href='multiplayer/index.html'">
            <div class="game-image"><img src="assets/multiplayer.png"></div>
        </div>

    </div>
</main>

<!-- FOOTER -->
<footer>
    <a href="about.html">About</a>
    <a href="contact.html">Contact</a>
    <a href="privacy.html">Privacy</a>
    <a href="terms.html">Terms</a>
</footer>

<!-- LOGIN/SIGNUP MODALS (unchanged) -->

<script type="module" src="/assets/js/index-auth.js"></script>

<!-- ðŸ”¥ FIX: Make Supabase session available immediately -->
<script>
document.addEventListener("DOMContentLoaded", async () => {
    if (typeof supabase === "undefined") return;

    const { data: { session } } = await supabase.auth.getSession();

    if (session?.user) {
        window.currentUser = session.user;
        if (typeof enableGames === "function") enableGames();
    }

    supabase.auth.onAuthStateChange((event, session) => {
        if (session?.user) {
            window.currentUser = session.user;
            if (typeof enableGames === "function") enableGames();
        } else {
            window.currentUser = null;
            if (typeof disableGames === "function") disableGames();
        }
    });
});
</script>

<!-- Original page-local JS -->
<script>
function enableGames() {
    document.querySelectorAll(".game-card").forEach(c=>c.classList.remove("disabled"));
}
function disableGames() {
    document.querySelectorAll(".game-card").forEach(c=>c.classList.add("disabled"));
}
window.enableGames = enableGames;
window.disableGames = disableGames;

/* Modal functions remain unchanged */
</script>

<!-- Load playerbar -->
<script>
async function loadPlayerBar(){
    try {
        const res = await fetch("playerbar.html");
        const html = await res.text();
        const container = document.getElementById("playerbar");
        const temp = document.createElement("div");
        temp.innerHTML = html;
        Array.from(temp.childNodes).forEach(node => {
            if (node.tagName === "SCRIPT") {
                const s = document.createElement("script");
                if (node.src) s.src = node.src;
                else s.textContent = node.textContent;
                document.body.appendChild(s);
            } else {
                container.appendChild(node);
            }
        });
    } catch (e) { console.error(e); }
}
document.addEventListener("DOMContentLoaded", loadPlayerBar);
</script>

</body>
</html>
